# On-Demand Deployment System
## üöÄ –°–∏—Å—Ç–µ–º–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–±–æ—Ä–∫–∏ –∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –≤ —Ä–µ–∂–∏–º–µ ondemand

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø–æ–∑–≤–æ–ª—è–µ—Ç –±—ã—Å—Ç—Ä–æ —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ —Å—Ç–µ–Ω–¥—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é. –ö–∞–∂–¥—ã–π —Å—Ç–µ–Ω–¥:
- –°–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø—É—à–µ –≤ –≤–µ—Ç–∫—É —Å —Å—É—Ñ—Ñ–∏–∫—Å–æ–º -ondemand (–Ω–∞–ø—Ä–∏–º–µ—Ä, test-ondemand).
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ Docker-–æ–±—Ä–∞–∑—ã, —Å–æ–±—Ä–∞–Ω–Ω—ã–µ –∏–∑ —É–∫–∞–∑–∞–Ω–Ω–æ–π –≤–µ—Ç–∫–∏ backend-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è.
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–∫–æ—Ä–æ—Ç–∫–æ–∂–∏–≤—É—â–∏–µ —Å—Ç–µ–Ω–¥—ã).

### üîß –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
1. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–±–æ—Ä–∫–∏ –∑–∞–¥–∞—é—Ç—Å—è –≤ —Ñ–∞–π–ª–µ ondemand.config:

```ini
BACK_BRANCH=main  # –í–µ—Ç–∫–∞ backend-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –¥–ª—è —Å–±–æ—Ä–∫–∏ –æ–±—Ä–∞–∑–∞
```

2. –¢—Ä–∏–≥–≥–µ—Ä —Å–±–æ—Ä–∫–∏

–ü—Ä–∏ –ø—É—à–µ –≤ –≤–µ—Ç–∫—É *-ondemand (–Ω–∞–ø—Ä–∏–º–µ—Ä, feature-auth-ondemand) GitHub Actions –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –°–æ–±–∏—Ä–∞–µ—Ç Docker-–æ–±—Ä–∞–∑ —Å —Ç–µ–≥–æ–º back-<env> (–Ω–∞–ø—Ä–∏–º–µ—Ä, back-feature-auth).
- –ü—É—à–∏—Ç –æ–±—Ä–∞–∑ –≤ GitHub Container Registry (ghcr.io).

3. –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ —Å—Ç–µ–Ω–¥–∞

–û–±—Ä–∞–∑—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å—Ç–µ–Ω–¥–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ Docker –∏–ª–∏ Kubernetes).

### üõ†Ô∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
1. –°–æ–∑–¥–∞–Ω–∏–µ ondemand-—Å—Ç–µ–Ω–¥–∞

```bash
git checkout -b mytest-ondemand  # –í–µ—Ç–∫–∞ –î–û–õ–ñ–ù–ê –æ–∫–∞–Ω—á–∏–≤–∞—Ç—å—Å—è –Ω–∞ "-ondemand"
git push origin mytest-ondemand
```

2. –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö –æ–±—Ä–∞–∑–æ–≤

–û–±—Ä–∞–∑—ã –¥–æ—Å—Ç—É–ø–Ω—ã –≤ [Packages —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è](https://github.com/hse-perm-ondemand/ondemand/pkgs/container/ondemand)

3. –ü—Ä–æ—Ü–µ—Å—Å —Å–±–æ—Ä–∫–∏ –∏ –∑–∞–ø—É—Å–∫–∞ —Å—Ç–µ–Ω–¥–∞:

```mermaid
graph LR
    A[–ü—É—à –≤ –≤–µ—Ç–∫—É *-ondemand] --> B[–°–±–æ—Ä–∫–∞ Docker-–æ–±—Ä–∞–∑–∞]
    B --> C[–ó–∞–≥—Ä—É–∑–∫–∞ –≤ ghcr.io]
    C --> D[–ó–∞–ø—É—Å–∫ —Å—Ç–µ–Ω–¥–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ]
    D --> E[–ê–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞ –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–æ–≤]
```